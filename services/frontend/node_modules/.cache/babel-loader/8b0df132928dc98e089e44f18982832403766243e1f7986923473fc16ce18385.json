{"ast":null,"code":"import BirthdayForm from './components/BirthdayForm.vue';\nimport UserInfo from './components/UserInfo.vue';\nexport default {\n  name: 'App',\n  components: {\n    BirthdayForm,\n    UserInfo\n  },\n  data() {\n    return {\n      birthday: '',\n      userInfo: null,\n      backgroundColor: '#ffffff',\n      isValidWebApp: false,\n      tg: null,\n      sharedData: null\n    };\n  },\n  mounted() {\n    // Проверяем, открыто ли приложение в Telegram\n    if (window.Telegram && window.Telegram.WebApp) {\n      this.tg = window.Telegram.WebApp;\n      this.isValidWebApp = true;\n\n      // Инициализация Telegram Web App\n      this.tg.ready();\n      this.tg.expand();\n\n      // Получаем информацию о пользователе\n      this.userInfo = this.tg.initDataUnsafe.user || {\n        first_name: 'Гость',\n        last_name: '',\n        username: 'guest'\n      };\n\n      // Используем цвет темы из Telegram\n      this.backgroundColor = this.tg.backgroundColor;\n\n      // Проверяем, есть ли параметры шаринга в URL\n      const urlParams = new URLSearchParams(window.location.search);\n      const shareId = urlParams.get('shareId');\n      if (shareId) {\n        // Получаем данные по shareId с бэкенда\n        this.loadSharedData(shareId);\n      }\n\n      // Добавляем обработчик событий\n      this.tg.onEvent('viewportChanged', () => {\n        this.tg.expand();\n      });\n      console.log('Telegram WebApp инициализирован:', {\n        user: this.userInfo,\n        theme: this.tg.colorScheme,\n        viewportHeight: this.tg.viewportHeight,\n        initData: this.tg.initData\n      });\n    }\n  },\n  methods: {\n    setBirthday(date) {\n      this.birthday = date;\n    },\n    async loadSharedData(shareId) {\n      try {\n        const response = await fetch(`http://localhost:8000/api/share/${shareId}`);\n        if (response.ok) {\n          this.sharedData = await response.json();\n        } else {\n          console.error('Failed to load shared data');\n        }\n      } catch (error) {\n        console.error('Error loading shared data:', error);\n      }\n    }\n  }\n};","map":{"version":3,"names":["BirthdayForm","UserInfo","name","components","data","birthday","userInfo","backgroundColor","isValidWebApp","tg","sharedData","mounted","window","Telegram","WebApp","ready","expand","initDataUnsafe","user","first_name","last_name","username","urlParams","URLSearchParams","location","search","shareId","get","loadSharedData","onEvent","console","log","theme","colorScheme","viewportHeight","initData","methods","setBirthday","date","response","fetch","ok","json","error"],"sources":["/Users/wiquzix/Desktop/tzrobita/src/App.vue"],"sourcesContent":["<template>\n  <div id=\"app\" :style=\"{ backgroundColor: backgroundColor }\">\n    <div v-if=\"!isValidWebApp\" class=\"error-message\">\n      Это приложение можно открыть только через Telegram\n    </div>\n    <div v-else-if=\"!userInfo\" class=\"loading\">\n      Загрузка...\n    </div>\n    <div v-else>\n      <template v-if=\"!sharedData\">\n        <BirthdayForm \n          v-if=\"!birthday\"\n          @birthday-submitted=\"setBirthday\"\n        />\n        <UserInfo\n          v-else\n          :userInfo=\"userInfo\"\n          :birthday=\"birthday\"\n        />\n      </template>\n      <template v-else>\n        <UserInfo\n          :userInfo=\"sharedData.userInfo\"\n          :birthday=\"sharedData.birthday\"\n        />\n      </template>\n    </div>\n  </div>\n</template>\n\n<script>\nimport BirthdayForm from './components/BirthdayForm.vue'\nimport UserInfo from './components/UserInfo.vue'\n\nexport default {\n  name: 'App',\n  components: {\n    BirthdayForm,\n    UserInfo\n  },\n  data() {\n    return {\n      birthday: '',\n      userInfo: null,\n      backgroundColor: '#ffffff',\n      isValidWebApp: false,\n      tg: null,\n      sharedData: null\n    }\n  },\n  mounted() {\n    // Проверяем, открыто ли приложение в Telegram\n    if (window.Telegram && window.Telegram.WebApp) {\n      this.tg = window.Telegram.WebApp;\n      this.isValidWebApp = true;\n      \n      // Инициализация Telegram Web App\n      this.tg.ready();\n      this.tg.expand();\n\n      // Получаем информацию о пользователе\n      this.userInfo = this.tg.initDataUnsafe.user || {\n        first_name: 'Гость',\n        last_name: '',\n        username: 'guest'\n      };\n      \n      // Используем цвет темы из Telegram\n      this.backgroundColor = this.tg.backgroundColor;\n\n      // Проверяем, есть ли параметры шаринга в URL\n      const urlParams = new URLSearchParams(window.location.search);\n      const shareId = urlParams.get('shareId');\n      if (shareId) {\n        // Получаем данные по shareId с бэкенда\n        this.loadSharedData(shareId);\n      }\n\n      // Добавляем обработчик событий\n      this.tg.onEvent('viewportChanged', () => {\n        this.tg.expand();\n      });\n\n      console.log('Telegram WebApp инициализирован:', {\n        user: this.userInfo,\n        theme: this.tg.colorScheme,\n        viewportHeight: this.tg.viewportHeight,\n        initData: this.tg.initData\n      });\n    }\n  },\n  methods: {\n    setBirthday(date) {\n      this.birthday = date;\n    },\n    async loadSharedData(shareId) {\n      try {\n        const response = await fetch(`http://localhost:8000/api/share/${shareId}`);\n        if (response.ok) {\n          this.sharedData = await response.json();\n        } else {\n          console.error('Failed to load shared data');\n        }\n      } catch (error) {\n        console.error('Error loading shared data:', error);\n      }\n    }\n  }\n}\n</script>\n\n<style>\n#app {\n  font-family: Arial, sans-serif;\n  min-height: 100vh;\n  padding: 20px;\n  color: var(--tg-theme-text-color, #000000);\n}\n\n.error-message {\n  color: red;\n  padding: 20px;\n  text-align: center;\n}\n\n.loading {\n  text-align: center;\n  padding: 20px;\n  color: var(--tg-theme-hint-color, #999);\n}\n\nh2 {\n  text-align: center;\n  margin-bottom: 20px;\n  color: var(--tg-theme-text-color, #000000);\n}\n</style>\n  \n  "],"mappings":"AA+BA,OAAOA,YAAW,MAAO,+BAA8B;AACvD,OAAOC,QAAO,MAAO,2BAA0B;AAE/C,eAAe;EACbC,IAAI,EAAE,KAAK;EACXC,UAAU,EAAE;IACVH,YAAY;IACZC;EACF,CAAC;EACDG,IAAIA,CAAA,EAAG;IACL,OAAO;MACLC,QAAQ,EAAE,EAAE;MACZC,QAAQ,EAAE,IAAI;MACdC,eAAe,EAAE,SAAS;MAC1BC,aAAa,EAAE,KAAK;MACpBC,EAAE,EAAE,IAAI;MACRC,UAAU,EAAE;IACd;EACF,CAAC;EACDC,OAAOA,CAAA,EAAG;IACR;IACA,IAAIC,MAAM,CAACC,QAAO,IAAKD,MAAM,CAACC,QAAQ,CAACC,MAAM,EAAE;MAC7C,IAAI,CAACL,EAAC,GAAIG,MAAM,CAACC,QAAQ,CAACC,MAAM;MAChC,IAAI,CAACN,aAAY,GAAI,IAAI;;MAEzB;MACA,IAAI,CAACC,EAAE,CAACM,KAAK,CAAC,CAAC;MACf,IAAI,CAACN,EAAE,CAACO,MAAM,CAAC,CAAC;;MAEhB;MACA,IAAI,CAACV,QAAO,GAAI,IAAI,CAACG,EAAE,CAACQ,cAAc,CAACC,IAAG,IAAK;QAC7CC,UAAU,EAAE,OAAO;QACnBC,SAAS,EAAE,EAAE;QACbC,QAAQ,EAAE;MACZ,CAAC;;MAED;MACA,IAAI,CAACd,eAAc,GAAI,IAAI,CAACE,EAAE,CAACF,eAAe;;MAE9C;MACA,MAAMe,SAAQ,GAAI,IAAIC,eAAe,CAACX,MAAM,CAACY,QAAQ,CAACC,MAAM,CAAC;MAC7D,MAAMC,OAAM,GAAIJ,SAAS,CAACK,GAAG,CAAC,SAAS,CAAC;MACxC,IAAID,OAAO,EAAE;QACX;QACA,IAAI,CAACE,cAAc,CAACF,OAAO,CAAC;MAC9B;;MAEA;MACA,IAAI,CAACjB,EAAE,CAACoB,OAAO,CAAC,iBAAiB,EAAE,MAAM;QACvC,IAAI,CAACpB,EAAE,CAACO,MAAM,CAAC,CAAC;MAClB,CAAC,CAAC;MAEFc,OAAO,CAACC,GAAG,CAAC,kCAAkC,EAAE;QAC9Cb,IAAI,EAAE,IAAI,CAACZ,QAAQ;QACnB0B,KAAK,EAAE,IAAI,CAACvB,EAAE,CAACwB,WAAW;QAC1BC,cAAc,EAAE,IAAI,CAACzB,EAAE,CAACyB,cAAc;QACtCC,QAAQ,EAAE,IAAI,CAAC1B,EAAE,CAAC0B;MACpB,CAAC,CAAC;IACJ;EACF,CAAC;EACDC,OAAO,EAAE;IACPC,WAAWA,CAACC,IAAI,EAAE;MAChB,IAAI,CAACjC,QAAO,GAAIiC,IAAI;IACtB,CAAC;IACD,MAAMV,cAAcA,CAACF,OAAO,EAAE;MAC5B,IAAI;QACF,MAAMa,QAAO,GAAI,MAAMC,KAAK,CAAC,mCAAmCd,OAAO,EAAE,CAAC;QAC1E,IAAIa,QAAQ,CAACE,EAAE,EAAE;UACf,IAAI,CAAC/B,UAAS,GAAI,MAAM6B,QAAQ,CAACG,IAAI,CAAC,CAAC;QACzC,OAAO;UACLZ,OAAO,CAACa,KAAK,CAAC,4BAA4B,CAAC;QAC7C;MACF,EAAE,OAAOA,KAAK,EAAE;QACdb,OAAO,CAACa,KAAK,CAAC,4BAA4B,EAAEA,KAAK,CAAC;MACpD;IACF;EACF;AACF","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}